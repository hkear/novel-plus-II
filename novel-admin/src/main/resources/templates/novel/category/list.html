<!DOCTYPE html>
<html>
<head th:include="include :: header"></head>
<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>小说分类管理</h5>
                    <div class="ibox-tools">
                        <a class="btn btn-primary btn-xs" th:href="@{/novel/category/add}">新增</a>
                    </div>
                </div>
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-sm-3">
                            <div class="input-group">
                                <input type="text" placeholder="分类名" class="form-control" id="name">
                                <span class="input-group-btn">
                                    <button class="btn btn-primary" type="button" onclick="reLoad()">搜索</button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <table class="table table-striped table-bordered table-hover" id="exampleTable"></table>
                </div>
            </div>
        </div>
    </div>
</div>
<div th:include="include :: footer"></div>
<script type="text/javascript">
    var prefix = "/novel/category";
    $(function() {
        load();
    });
    function load() {
        $('#exampleTable').bootstrapTable({
            url: prefix + "/list",
            queryParams: function(params) {
                return {
                    limit: params.limit,
                    offset: params.offset,
                    name: $('#name').val()
                };
            },
            columns: [
                {checkbox: true},
                {title: '序号', formatter: function(value, row, index) {return index+1;}},
                {field: 'name', title: '分类名'},
                {field: 'directionName', title: '作品方向'},
                {field: 'sort', title: '排序'},
                {title: '操作', formatter: function(value, row, index) {
                    return '<a th:href="@{/novel/category/edit/'+row.id+'}" class="btn btn-primary btn-xs">编辑</a> ' +
                           '<a class="btn btn-danger btn-xs" onclick="del('+row.id+')">删除</a>';
                }}
            ]
        });
    }
    function reLoad() {$('#exampleTable').bootstrapTable('refresh');}
    function del(id) {
        layer.confirm('确定删除该分类？', function() {
            $.post(prefix + "/remove", {id: id}, function(r) {
                if(r.code === 0) {layer.msg(r.msg); reLoad();}
                else {layer.msg(r.msg);}
            });
        });
    }
</script>
</body>
</html>